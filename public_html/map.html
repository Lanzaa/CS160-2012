<html>
  <script>
    var map, geocoder;
    // initialize the map and geocoder objects, assign autocomplete to location text field.
    function initialize() {
      // required options for the map.
      var mapOptions = { zoom: 10, center: new google.maps.LatLng(0, 0), mapTypeId: google.maps.MapTypeId.ROADMAP };
      // the field object where location is typed in.
      var input = document.getElementsByName('location')[0];
      //enable autocomplete on input field, and update map when autocomplete option clicked.
      autocomplete = new google.maps.places.Autocomplete(input);
      google.maps.event.addListener(autocomplete, 'place_changed', function() {
        map.setCenter(autocomplete.getPlace().geometry.location);
      });
      // create a map, listener for map location changed
      map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
      google.maps.event.addListener(map, 'center_changed', function() { updateLocation(input); });
      // create a geocoder for lat-long translatiion.
      geocoder = new google.maps.Geocoder();
      // initially place the map where the user has given us a location.
      updateMap(input.value);
    }

    // load the google maps api for use, run via window.onload after website is done loading.
    function loadScript() {
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.src = 'https://maps.googleapis.com/maps/api/js?&sensor=false&libraries=places&callback=initialize';
      document.body.appendChild(script);
    }
    window.onload = loadScript;

    // update the map's displayed area based on where the user typed in.
    function updateMap(location) {
      // if the location is not empty, update the map.
      if (location != "") {
        geocoder.geocode({ 'address': location }, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK)
            map.setCenter(results[0].geometry.location);
        });
      }
    }

    // update the location test field based on where the map has been moved to.
    function updateLocation(field) {
      geocoder.geocode({ 'latLng': map.getCenter() }, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK && results[1])
          field.value = results[1].formatted_address;
      });
    }
  </script>
  <body>
    <form onsubmit="updateMap(document.getElementsByName('location')[0].value);return false" method="get">
      Location: <input id="location" type="text" name="location" size="40">
      <input type="submit" value="Search">
    </form>
    <div id="map_canvas" style="width:500px; height:500px"></div>
  </body>
</html>

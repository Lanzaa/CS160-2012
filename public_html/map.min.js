google.maps.event.addDomListener(window,"load",init);var map,markers=[];
function init(){mapOptions={zoom:10,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP};input=document.getElementsByName("location")[0];autocomplete=new google.maps.places.Autocomplete(input);google.maps.event.addListener(autocomplete,"place_changed",function(){map.setCenter(autocomplete.getPlace().geometry.location)});map=new google.maps.Map(document.getElementById("map_canvas"),mapOptions);google.maps.event.addListener(map,"center_changed",function(){updateLocation(input)});
updateMap(input.value);parseJSON("./results/results.json")}function updateMap(a){""!=a&&(new google.maps.Geocoder).geocode({address:a},function(a,c){c==google.maps.GeocoderStatus.OK&&map.setCenter(a[0].geometry.location)})}
function updateLocation(a){(new google.maps.Geocoder).geocode({latLng:map.getCenter()},function(b,c){if(c==google.maps.GeocoderStatus.OK)for(i=0;i<b.length;i++)for(j=0;j<b[i].types.length;j++)"locality"==b[i].types[j]&&"undefined"!=b[i].formatted_address&&(a.value=b[i].formatted_address)})}
function addMarker(a){""==a.name||""==a.city||(new google.maps.Geocoder).geocode({address:a.city},function(b,c){c==google.maps.GeocoderStatus.OK?(new google.maps.places.PlacesService(map)).nearbySearch({location:b[0].geometry.location,radius:5E4,name:a.name},createMarker(a)):(console.log(c),setTimeout(function(){addMarker(a)},250))})}
function createMarker(a){return out=function(b,c){c==google.maps.places.PlacesServiceStatus.OK&&(marker=new google.maps.Marker({map:map,position:b[0].geometry.location}),markers.push(marker),infowindow=new google.maps.InfoWindow({disableAutoPan:!0}),google.maps.event.addListener(marker,"mouseover",function(){infowindow.setContent(getContent(a));infowindow.open(map,this)}),google.maps.event.addListener(marker,"mouseout",function(){infowindow.close()}),resizeMap())}}
function parseJSON(a){$.getJSON(a,function(a){$.each(a,function(a,b){addMarker(b)})})}function getContent(a){return a.company+" in "+a.city+"\n"+a.title+"\n"+a.salary}function resizeMap(){var a=-90,b=-180,c=90,d=180;for(i=0;i<markers.length;i++)curLat=markers[i].position.lat(),curLng=markers[i].position.lng(),a=a<curLat?curLat:a,b=b<curLng?curLng:b,c=c>curLat?curLat:c,d=d>curLng?curLng:d;map.fitBounds(new google.maps.LatLngBounds(new google.maps.LatLng(c,d),new google.maps.LatLng(a,b)))};

